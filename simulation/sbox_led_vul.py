STUCK_AT_0 = 0

def G1_(x11, x12, x13, x21, x22, x23, x31, x32, x33, x41, x42, x43):
    a11 = x22 ^ x32 ^ x42 ^ x12 ^ x23 ^ (x32&x23) ^ (x22&x33) ^ (x23&x33)
    a12 = x13 ^ x23 ^ x33 ^ x43 ^ x21 ^ (x33&x21) ^ (x23&x31) ^ (x21&x31)
    a13 = x11 ^ x21 ^ x31 ^ x41 ^ x22 ^ (x31&x22) ^ (x21&x32) ^ (x22&x32)
    return a11, a12, a13

def G2_(x11, x12, x13):
    a21 = x12
    a22 = x13
    a23 = x11
    return a21, a22, a23

def G3_(x11, x12, x13, x21, x22, x23, x31, x32, x33, x41, x42, x43):
    a31 = 1 ^ x42 ^ x12 ^ x23 ^ (x32&x23) ^ (x22&x33) ^ (x23&x33)
    a32 = 1 ^ x13 ^ x43 ^ x21 ^ (x33&x21) ^ (x23&x31) ^ (x21&x31)
    a33 = 1 ^ x11 ^ x41 ^ x22 ^ (x31&x22) ^ (x21&x32) ^ (x22&x32)
    return a31, a32, a33

def G4_(x11, x12, x13, x21, x22, x23, x31, x32, x33, x41, x42, x43):
    a41 = 1 ^ x22 ^ x12 ^ x23 ^ (x32&x23) ^ (x22&x33) ^ (x23&x33) ^ (x42&x23) ^ (x42&x33) ^ (x22&x43) ^ (x32&x43) ^ (x23&x43) ^ (x33&x43)
    a42 = 1 ^ x13 ^ x23 ^ x21 ^ (x33&x21) ^ (x43&x21) ^ (x23&x31) ^ (x43&x31) ^ (x21&x31) ^ (x23&x41) ^ (x33&x41) ^ (x21&x41) ^ (x31&x41)
    a43 = 1 ^ x11 ^ x21 ^ x22 ^ (x31&x22) ^ (x41&x22) ^ (x21&x32) ^ (x41&x32) ^ (x22&x32) ^ (x21&x42) ^ (x31&x42) ^ (x22&x42) ^ (x32&x42)
    return a41, a42, a43

def F1_(x11, x12, x13):
    a11 = x12
    a12 = x13
    a13 = x11
    return a11, a12, a13

def F2_(x21, x22, x23, x31, x32, x33, x41, x42, x43):
    a21 = x32 ^ x42 ^ (x42&x23) ^ (x22&x43) ^ (x23&x43)
    a22 = x33 ^ x43 ^ (x43&x21) ^ (x23&x41) ^ (x21&x41)
    a23 = x31 ^ x41 ^ (x41&x22) ^ (x21&x42) ^ (x22&x42)
    return a21, a22, a23

def F3_(x11, x12, x13, x21, x22, x23, x31, x32, x33, x41, x42, x43):
    a31 = 1 ^ x12 ^ x22 ^ x32 ^ (x42&x33) ^ (x32&x43) ^ (x33&x43)
    a32 = 1 ^ x13 ^ x23 ^ x33 ^ (x43&x31) ^ (x33&x41) ^ (x31&x41)
    a33 = 1 ^ x11 ^ x21 ^ x31 ^ (x41&x32) ^ (x31&x42) ^ (x32&x42)
    return a31, a32, a33

def F4_(x21, x22, x23, x31, x32, x33, x41, x42, x43):
    a41 = x32 ^ (x42&x23) ^ (x22&x43) ^ (x23&x43)
    a42 = x33 ^ (x43&x21) ^ (x23&x41) ^ (x21&x41)
    a43 = x31 ^ (x41&x22) ^ (x21&x42) ^ (x22&x42)
    return a41, a42, a43

def sbox_led_vulnerable(x11, x12, x13, x21, x22, x23, x31, x32, x33, x41, x42, x43):
    x22 = STUCK_AT_0
    y11, y12, y13 = G1_(x11, x12, x13, x21, x22, x23, x31, x32, x33, x41, x42, x43)
    y21, y22, y23 = G2_(x11, x12, x13)
    y31, y32, y33 = G3_(x11, x12, x13, x21, x22, x23, x31, x32, x33, x41, x42, x43)
    y41, y42, y43 = G4_(x11, x12, x13, x21, x22, x23, x31, x32, x33, x41, x42, x43)

    a11, a12, a13 = F1_(y11, y12, y13)
    a21, a22, a23 = F2_(y21, y22, y23, y31, y32, y33, y41, y42, y43)
    a31, a32, a33 = F3_(y11, y12, y13, y21, y22, y23, y31, y32, y33, y41, y42, y43)
    a41, a42, a43 = F4_(y21, y22, y23, y31, y32, y33, y41, y42, y43)
    return a11, a12, a13, a21, a22, a23, a31, a32, a33, a41, a42, a43
